---
title: Convert HTML to EML
type: docs
weight: 60
url: /net/converting-between-formats/convert-html-to-other-formats
---


One of the key features of Aspose.Email for .NET is the ability to convert files between various formats. With its user-friendly APIs, developers command a comprehensive suite of tools, facilitating effortless conversion of email file formats within .NET applications. This empowers developers to manage and manipulate email content, enhancing efficiency and flexibility. Moreover, the resulting output files ensure compatibility across diverse platforms and devices, ensuring accessibility irrespective of the chosen email client or device. In this tutorial, we introduce the API's ability to convert files from HTML to EML, EMLX, ICS, MBOX, MHTML, MSG, OFT, OST, PST, and VCF formats. The formatting of the original HTML content (styling, layout, and any embedded elements) is preserved during the conversion process. The output files are compatible with various email clients and platforms, ensuring seamless interoperability across different environments.   

## **Convert HTML to EML**

Aspose.Email for .NET provides a straightforward method to convert HTML files to EML format using the [MailMessage.Load](https://reference.aspose.com/email/net/aspose.email/mailmessage/load/#load_3) and [MailMessage.Save](https://reference.aspose.com/email/net/aspose.email/mailmessage/save/#save_3) methods to load th existing HTML file and save it in EML format respectively. The following code sample shows you how to perform this task:


```cs
var eml = MailMessage.Load("myContent.html", new HtmlLoadOptions());
eml.Save("output.eml", SaveOptions.DefaultEml);
```

In the code sample, the [HtmlLoadOptions](https://reference.aspose.com/email/net/aspose.email/htmlloadoptions/#htmlloadoptions-class) class allows you to specify additional options when loading a MailMessage from HTML format. With its properties, you can get/set preferred encoding for a message, remove signature and more. The following code sample demonstrates the use of this class. In the example, it specifies a text representation of the message body:

```cs
// Create an instance of HtmlLoadOptions
var loadOptions = new HtmlLoadOptions();

// Set the ShouldAddPlainTextView property to true to generate a plain text view along with HTML
loadOptions.ShouldAddPlainTextView = true;

// Load an HTML file
var mailMessage = MailMessage.Load("input.html", loadOptions);

// Access the plain text view of the email message
var plainTextView = mailMessage.GetAlternateViewContent("text/plain");

// Print or further process the plain text view
Console.WriteLine("Plain Text View:");
Console.WriteLine(plainTextView);
```

The [SaveOptions.DefaultEml]() gets options with default values for saving message to EML format. If you want to apply additional options, use the [EmlSaveOptions](https://reference.aspose.com/email/net/aspose.email/emlsaveoptions/#emlsaveoptions-class) class. Its properties allow you to preserve the embedded message format, define inner conversions, that are necessarily to be done when saving a message, and more. The following code sample shows you how to use the [EmlSaveOptions.FileCompatibilityMode](https://reference.aspose.com/email/net/aspose.email/emlsaveoptions/filecompatibilitymode/#emlsaveoptionsfilecompatibilitymode-property) and [PreserveEmbeddedMessageFormat]() properties, as an example, to enable TNEF attachment saving and preserve the format of the embedded message:

```cs
// Load an existing EML file
var eml = MailMessage.Load("input.eml");

// Create an instance of EmlSaveOptions and set the properties
var saveOptions = new EmlSaveOptions
{
    PreserveEmbeddedMessageFormat = true,
  FileCompatibilityMode = FileCompatibilityMode.PreserveTnefAttachments
};
// Save the MailMessage to EML format with the specified compatibility mode
eml.Save("output.eml", saveOptions);
```


## **Convert HTML to EMLX**

You can easily convert HTML files to EMLX format using Aspose.Email for .NET. All the properties and classes provided by the API for HTML to EML conversion are available for this type of conversion as well. The following code sample demonstrates how to perform the conversion task:

```cs
var eml = MailMessage.Load("myContent.html", new HtmlLoadOptions());
eml.Save("output.emlx", SaveOptions.DefaultEmlx);
```
For additional settings, see [Convert HTML to EML](#convert-html-to-eml) paragraph.

## **Convert HTML to ICS**

Creating calendar events or appointments from the content of the HTML files is easy with Aspose.Email for .NET. The ICS format generated by the API is compatible with various calendar applications such as Microsoft Outlook, Google Calendar, and Apple Calendar. This ensures seamless integration and interoperability across different platforms and devices. To perform the task, the library offers the [Appointment](https://reference.aspose.com/email/net/aspose.email.calendar/appointment/#appointment-class) class to represent and manage calendar events. The following code sample demonstrates how to create an appointment using the Appointment class using Aspose.Email for .NET and save it to an ICS (iCalendar) file format:

```cs
// Sample HTML content
var htmlContent = File.ReadAllText("content.html");

// Create and initialize an instance of the Appointment class
var appointment = new Appointment(
    "Meeting Room 3 at Office Headquarters",// Location
    "Monthly Meeting",                      // Summary
    "Please confirm your availability.",    // Description
    new DateTime(2015, 2, 8, 13, 0, 0),     // Start date
    new DateTime(2015, 2, 8, 14, 0, 0),     // End date
    "from@domain.com",                      // Organizer
    "attendees@domain.com")
{
    HtmlDescription = htmlContent
};

// Save the event to an ICS file
appointment.Save("output.ics", AppointmentSaveFormat.Ics);
```


## **Convert HTML to MBOX**

With Aspose.Email, developers can easily generate MBOX files from HTML content, enabling seamless integration with various email systems. To perform HTML to MBOX conversion, use the [Load](https://reference.aspose.com/email/net/aspose.email/mailmessage/load/#load_3) method of the [MailMessage](https://reference.aspose.com/email/net/aspose.email/mailmessage/#mailmessage-class) class, specifying the HTML content file path and an instance of [HtmlLoadOptions](https://reference.aspose.com/email/net/aspose.email/htmlloadoptions/). This method parses the HTML content and generates a corresponding MailMessage object, preserving the structure and formatting of the original HTML. After loading the HTML content into a MailMessage object, write the message to an MBOX file using the [MboxrdStorageWriter](https://reference.aspose.com/email/net/aspose.email.storage.mbox/mboxrdstoragewriter/#mboxrdstoragewriter-class) class. The following code sample demonstrates how to convert HTML content to an email message and write it to an MBOX file:


```cs
using (var eml = MailMessage.Load("content.html", new HtmlLoadOptions())){
    using (var writer = new MboxrdStorageWriter("output.mbox", false)){
        writer.WriteMessage(eml);
    }
}
```
Additionally, with the [HtmlLoadOptions](https://reference.aspose.com/email/net/aspose.email/htmlloadoptions/) class, you can specify various options when loading MailMessage from Html format. For example, it allows you to remove signature from the message, if set to 'true'. The following code sample shows how to perform the task:

```cs
// Create an instance of HtmlLoadOptions
var loadOptions = new HtmlLoadOptions();

// Set the RemoveSignature property to true to remove signatures
loadOptions.RemoveSignature = true;

// Load an HTML file
var mailMessage = MailMessage.Load("input.html", loadOptions);
```
The message will be loaded for further manipulations without a signature.

## **Convert HTML to MHTML**

To create rich, visually appealing email messages from HTML content, Aspose.Email offers you an effective functionality which allows you to generate MHTML files from HTML content encapsulating all resources (such as images and stylesheets) within a single file. Use the [Load](https://reference.aspose.com/email/net/aspose.email/mailmessage/load/#load_3) method of the [MailMessage](https://reference.aspose.com/email/net/aspose.email/mailmessage/#mailmessage-class) class to load the existing file, specifying a path to it and an instance of [HtmlLoadOptions](https://reference.aspose.com/email/net/aspose.email/htmlloadoptions/). This method parses the HTML content and generates a corresponding MailMessage object, preserving the structure and formatting of the original HTML. After loading the HTML content into a MailMessage object, developers can save it as an MHTML file using the [Save](https://reference.aspose.com/email/net/aspose.email/mailmessage/save/#save_3) method, specifying the desired output file path and utilizing the [SaveOptions.DefaultMhtml](https://reference.aspose.com/email/net/aspose.email/saveoptions/defaultmhtml/) option. This option ensures that the output file is saved in the standard MHTML format, encapsulating all resources referenced in the HTML content.

```cs
var eml = MailMessage.Load("content.html", new HtmlLoadOptions());
eml.Save("output.mhtml", SaveOptions.DefaultMhtml);
```
The [HtmlLoadOptions](https://reference.aspose.com/email/net/aspose.email/htmlloadoptions/) class also allows to set additional options for loading a file such as removing a signature or adding a plain text representation of the message body. To leverage this functionality, use its [properties](https://reference.aspose.com/email/net/aspose.email/htmlloadoptions/#properties) and code samples shown in [Convert HTML to EML](#convert-html-to-eml) and [Convert HTML to MBOX](#convert-html-to-mbox).

The [MhtSaveOptions](https://reference.aspose.com/email/net/aspose.email/mhtsaveoptions/#mhtsaveoptions-class) class provides a variety of options for configuring the behavior and settings of the output MHTML file instead of the SaveOptions.DefaultMhtml. With its [properties](https://reference.aspose.com/email/net/aspose.email/mhtsaveoptions/#properties), you can specify additional options when saving MailMessage to MHTML format.
The most popular of them are:

- [MhtFormatOptions](https://reference.aspose.com/email/net/aspose.email/mhtsaveoptions/mhtformatoptions/) - Allows you to customize how the email message is saved in MHT format to best suit your needs.
- [SaveAttachments](https://reference.aspose.com/email/net/aspose.email/mhtsaveoptions/saveattachments/) - Gets or sets a value indicating whether to save attachments.
- [SaveAllHeaders](https://reference.aspose.com/email/net/aspose.email/mhtsaveoptions/saveallheaders/) - Defines whether need to save all headers in output mhtml or not. Default value is false.
- [PreserveOriginalDate](https://reference.aspose.com/email/net/aspose.email/mhtsaveoptions/preserveoriginaldate/) - Defines whether need keep original date in mail message when saving or not. Default value is true.

The following code sample demonstrates how these properties can be implemented into a project:

```cs
var mhtSaveOprtions = new MhtSaveOptions
{
    MhtFormatOptions = MhtFormatOptions.WriteHeader,
    SaveAttachments = true,
    SaveAllHeaders = true,
    PreserveOriginalDate = true
}
```

## **Convert HTML to MSG**

To convert HTML content to MSG (Outlook Message) format, you can use Aspose.Email methods. The [Load](https://reference.aspose.com/email/net/aspose.email/mailmessage/load/#load_3) method of the [MailMessage](https://reference.aspose.com/email/net/aspose.email/mailmessage/#mailmessage-class) class parses the HTML content, generating a corresponding MailMessage object while preserving the original structure and formatting. Specify the path to the HTML content file and an instance of [HtmlLoadOptions](https://reference.aspose.com/email/net/aspose.email/htmlloadoptions/). After loading the HTML content into a MailMessage object, save it as an MSG file using the [Save](https://reference.aspose.com/email/net/aspose.email/mailmessage/save/#save_3) method, specifying the desired output file path and utilizing the [SaveOptions.DefaultMsgUnicode](https://reference.aspose.com/email/net/aspose.email/saveoptions/defaultmsgunicode/) option. This option ensures that the output file is saved in the MSG format with Unicode encoding, supporting international characters and ensuring compatibility with various email clients.

```cs
var eml = MailMessage.Load("content.html", new HtmlLoadOptions());
eml.Save("output.msg", SaveOptions.DefaultMsgUnicode);
```
Additionally, Aspose.Email for .NET offers a range of advanced features and options for HTML to MSG conversion:

**Attachment Handling**
  
You can include email attachments in the MSG file by iterating through each attachment in the Attachments collection of the [MailMessage](https://reference.aspose.com/email/net/aspose.email/mailmessage/#mailmessage-class) object. For each attachment, use the [Save](https://reference.aspose.com/email/net/aspose.email/attachmentbase/save/) method to save it to the MSG file.

```cs
// Load an existing email message
MailMessage message = MailMessage.Load("input.eml");

// Iterate through each attachment
foreach (Attachment attachment in message.Attachments)
{
    // Save each attachment to the MSG file
    attachment.Save(outputFileName);
}
```

**Header Manipulation**

The library also allows you to modify email headers, such as subject, sender, recipients, and date, before saving the message to the MSG file. This flexibility enables customization of the email message metadata to suit specific requirements.

```cs
// Load an existing email message
MailMessage message = MailMessage.Load("input.eml");

// Modify email headers
message.Subject = "Modified Subject";
message.From = new MailAddress("new.sender@example.com");
message.To.Clear();
message.To.Add("new.recipient@example.com");

// Save the modified message to the MSG file
message.Save("output.msg", SaveOptions.DefaultMsgUnicode);
```

**Add Custom Properties**

You can add custom properties to the MSG file, providing additional metadata or information associated with the email message. For this task Aspose.Email offers the [Add](https://reference.aspose.com/email/net/aspose.email.mime/headercollection/add/#add_2) method of the [HeaderCollection](https://reference.aspose.com/email/net/aspose.email.mime/headercollection/#headercollection-class) class. The following code sample shows how to add custom properties to the MSG file:

```cs
// Load an existing email message
MailMessage message = MailMessage.Load("input.eml");

// Add custom properties
message.Headers.Add("X-Custom-Property1", "Value1");
message.Headers.Add("X-Custom-Property2", "Value2");

// Save the message to the MSG file with custom properties
message.Save("output.msg", SaveOptions.DefaultMsgUnicode);
```


## **Convert HTML to OFT**

To convert HTML content to Outlook Template (OFT) format, Aspose.Email offers the [Load](https://reference.aspose.com/email/net/aspose.email/mailmessage/load/#load_3) method of the [MailMessage](https://reference.aspose.com/email/net/aspose.email/mailmessage/#mailmessage-class) class. This method parses the HTML content and generates a corresponding MailMessage object, preserving the structure and formatting of the original HTML. Specify the HTML content file path and additional options using the instance of the [HtmlLoadOptions](https://reference.aspose.com/email/net/aspose.email/htmlloadoptions/#htmlloadoptions-class) class. After loading the HTML content into a MailMessage object, save it as an OFT file using the [Save](https://reference.aspose.com/email/net/aspose.email/mailmessage/save/#save_3) method, specifying the desired output file path and utilizing the [SaveOptions.DefaultOft](https://reference.aspose.com/email/net/aspose.email/saveoptions/defaultoft/) option. This option ensures that the output file is saved in the standard OFT format, compatible with Microsoft Outlook.

```cs
var eml = MailMessage.Load("content.html", new HtmlLoadOptions());
eml.Save("template.oft", SaveOptions.DefaultOft);
```
Additionally, Aspose.Email for .NET offers a range of advanced features and options for HTML to OFT conversion:

### **How to Handle Attachments when Converting HTML to OFT**

This feature allows you to include email attachments in the OFT file by iterating through the MailMessage object's [Attachments](https://reference.aspose.com/email/net/aspose.email/attachment/#attachment-class) collection and saving each attachment to the OFT file using the [Save](https://reference.aspose.com/email/net/aspose.email/attachmentbase/save/) method. The following code sample demonstrates how to implement this feature to your project:

```cs
// Load an existing email message
MailMessage message = MailMessage.Load("input.eml");

// Iterate through each attachment
foreach (Attachment attachment in message.Attachments)
{
    // Save each attachment to the OFT file
    attachment.Save(outputFileName);
}
```
### **How to Manipulate Headers**

Aspose.Email also makes it possible to modify email headers, such as subject, sender, recipients, and date, before saving the message to the OFT file. This flexibility enables customization of the email message metadata to suit specific requirements. The following code sample demonstrates how to modify headers in the email message:

```cs
// Load an existing email message
MailMessage message = MailMessage.Load("input.eml");

// Modify email headers
message.Subject = "Modified Subject";
message.From = new MailAddress("new.sender@example.com");
message.To.Clear();
message.To.Add("new.recipient@example.com");

// Save the modified message to the OFT file
message.Save("output.oft", SaveOptions.DefaultOft);
```


## **Convert HTML to OST**

To convert HTML content to Outlook Data File (OST) format, Aspose.Email offers a variety of robust components. The following code sample with steps will show you how these components work together to add HTML content to OST file:

1. Load an existing OST file with the [FromFile](https://reference.aspose.com/email/net/aspose.email.storage.pst/personalstorage/fromfile/#fromfile) method of the [PersonalStorage](https://reference.aspose.com/email/net/aspose.email.storage.pst/personalstorage/#personalstorage-class) class used to represent the storage file that will store the email messages. 
2. Load the HTML file using the [Load](https://reference.aspose.com/email/net/aspose.email.mapi/mapimessage/load/#load_3) method of the [MapiMessage](https://reference.aspose.com/email/net/aspose.email.mapi/mapimessage/#mapimessage-class) class representing an email message in Microsoft Outlook format. 
3. Specify [HtmlLoadOptions](https://reference.aspose.com/email/net/aspose.email/htmlloadoptions/#htmlloadoptions-class) to enable additional options when loading MailMessage from HTML format.
4. Retrieve the root folder of the OST file using the [RootFolder](https://reference.aspose.com/email/net/aspose.email.storage.pst/personalstorage/rootfolder/) property of the [PersonalStorage](https://reference.aspose.com/email/net/aspose.email.storage.pst/personalstorage/#personalstorage-class) object.
5. Obtain the Inbox folder within the OST file using the [GetSubFolder](https://reference.aspose.com/email/net/aspose.email.storage.pst/folderinfo/getsubfolder/#getsubfolder) method on the root folder.
6. Add the loaded MapiMessage object (representing the HTML content) to the Inbox folder using the [AddMessage](https://reference.aspose.com/email/net/aspose.email.storage.pst/folderinfo/addmessage/) method on the folder.

```cs
using (var ost = PersonalStorage.FromFile("storage.ost"))
{
    var msg = MapiMessage.Load("content.html", new HtmlLoadOptions());
    var folderInfo = ost.RootFolder.GetSubFolder("Inbox");
    folderInfo.AddMessage(msg);
}
``` 
### **Include Email Attachments in the OST File**

Aspose.Email allows you to preserve email attachments in the output OST file. It is achieved by iterating through the [Attachments](https://reference.aspose.com/email/net/aspose.email/attachment/#attachment-class) collection of the [MapiMessage](https://reference.aspose.com/email/net/aspose.email.mapi/mapimessage/#mapimessage-class) object and adding each attachment to the message before adding it to the OST file. The following code sample demonstrates how to add email attachments to the output file during the HTML to OST conversion:

```cs
// Load an existing OST file
using (var ost = PersonalStorage.FromFile("input.ost"))
{
    // Load the HTML content into a MapiMessage object
    var msg = MapiMessage.Load("content.html", new HtmlLoadOptions());

    // Iterate through each attachment in the MapiMessage
    foreach (var attachment in msg.Attachments)
    {
        // Add each attachment to the MapiMessage before adding it to the OST file
        msg.Attachments.Add(attachment);
    }

    // Get the root folder of the OST file and add the message to the Inbox folder
    var folderInfo = ost.RootFolder.GetSubFolder("Inbox");
    folderInfo.AddMessage(msg);
}
```

## **Convert HTML to PST**

HTML to PST conversion involves creating a new PST (Personal Storage Table) file with a new folder, loading an HTML file and adding it to the new folder. This simple process preserves the original formatting, styles, and structure of the HTML content, ensuring accurate representation within the PST file. The following code sample demonstrates how to create a new storage file and import HTML content into it using Aspose.Email for .NET:

1. Create an instance of a PersonalStorage object representing a new PST file named "outputFile.pst" with Unicode format version using the [Create](https://reference.aspose.com/email/net/aspose.email.storage.pst/personalstorage/create/#create_4) method of the [PersonalStorage](https://reference.aspose.com/email/net/aspose.email.storage.pst/personalstorage/#personalstorage-class) class.
2. Access the root folder of the PST file and add a subfolder named "Inbox" to it using the [AddSubFolder](https://reference.aspose.com/email/net/aspose.email.storage.pst/folderinfo/addsubfolder/#addsubfolder) method of the [FolderInfo](https://reference.aspose.com/email/net/aspose.email.storage.pst/folderinfo/#folderinfo-class) class.
3. Load the content of an HTML file named "content.html" into a [MapiMessage](https://reference.aspose.com/email/net/aspose.email.mapi/mapimessage/#mapimessage-class) object using the [Load](https://reference.aspose.com/email/net/aspose.email.mapi/mapimessage/load/#load_3) method with an instance of [HtmlLoadOptions](https://reference.aspose.com/email/net/aspose.email/htmlloadoptions/#htmlloadoptions-class) to specify that the content is in HTML format.
4. Add the loaded MapiMessage object (representing the HTML content) to the "Inbox" folder within the PST file using the [AddMessage](https://reference.aspose.com/email/net/aspose.email.storage.pst/folderinfo/addmessage/) method.

```cs
using (var pst = PersonalStorage.Create("outputFile.pst", FileFormatVersion.Unicode))
{ 
    var inbox = pst.RootFolder.AddSubFolder("Inbox");
    var msg = MapiMessage.Load("content.html", new HtmlLoadOptions());
    inbox.AddMessage(msg);
}
```
By utilizing methods and properties of the [PersonalStorage](https://reference.aspose.com/email/net/aspose.email.storage.pst/personalstorage/#personalstorage-class) class, users can specify various aspects of the conversion process such as the output PST file location, folder structure, item properties, and conversion settings, thus, tailoring the conversion process according to their specific requirements, enhancing flexibility and customization.

## **Convert HTML to VCF**

Aspose.Email for .NET provides powerful functionalities for converting HTML content to VCF (Virtual Contact File) format, enabling seamless integration into various contact management applications. The process involves reading the content of an HTML file, creating a contact item, specifying its properties, assigning the HTML content to the body of the contact and saving it to a VCF file. The number of components provide you with tools for managing contact information and generating VCF files from HTML content:

- [MapiContact](https://reference.aspose.com/email/net/aspose.email.mapi/mapicontact/#mapicontact-class) class allows you to create and manipulate contact objects. With its properties and methods, you can set and manage various attributes of contacts, including display name, email address, phone numbers, and more.
- [SetBodyContent](https://reference.aspose.com/email/net/aspose.email.mapi/mapicontact/setbodycontent/#setbodycontent) method of the MapiContact class enables developers to set the body content of a contact item. By specifying the HTML content and setting the body content type as HTML, developers can seamlessly incorporate HTML content into VCF files. It is crucial for preserving the formatting and structure of HTML content within the VCF file, ensuring accurate representation of contact information.
- [ContactSaveFormat](https://reference.aspose.com/email/net/aspose.email.mapi/contactsaveformat/) enumeration provides predefined constants for specifying the desired output format in which contact items should be saved. In this case 'VCard' constant is used to specify the VCF format.

The following code sample demonstrates how to create a contact item, populate it with HTML content, and save it to a VCF file:

1. Read the content of an HTML file named "content.html" into a string variable using the File.ReadAllText method.
2. Create a new MapiContact object by instantiating the [MapiContact](https://reference.aspose.com/email/net/aspose.email.mapi/mapicontact/#mapicontact-class) class.
3. Set the contact properties: display name, email address.
4. Set the body content of the contact to HTML using [SetBodyContent](https://reference.aspose.com/email/net/aspose.email.mapi/mapicontact/setbodycontent/#setbodycontent).
5. Save the contact as a VCF file named "contact.vcf" using the [Save](https://reference.aspose.com/email/net/aspose.email.mapi/mapicontact/save/#save_4) method.

```cs
var content = File.ReadAllText("content.html");
            
// Create a new MapiContact
var contact = new MapiContact();
contact.NameInfo.DisplayName = "John Doe";
contact.ElectronicAddresses.Email1.EmailAddress = "john.doe@example.com";
contact.SetBodyContent(content, BodyContentType.Html);

// Save the contact to a VCF file
contact.Save("contact.vcf", ContactSaveFormat.VCard)
```
